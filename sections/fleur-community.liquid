{% comment %}
  Fleur Community
  - Works even if the section is rendered inside a parent .container
  - Forces full-bleed at the section level (100vw breakout)
  - Desktop: split bg layer + container grid
  - Mobile: stacked blocks (full-bleed bg with container text, then full-bleed image)
{% endcomment %}

<section class="fleur-community fleur-community--{{ section.id }}">
  <div class="fleur-community__bleed">

    <!-- =========================
         DESKTOP LAYOUT
    ========================== -->
    <div class="fleur-community__desktop">
      <div class="fleur-community__stage">

        <!-- FULL-BLEED BACKGROUND LAYER -->
        <div class="fleur-community__bg" aria-hidden="true">
          <div class="fleur-community__bg-left"></div>
          <div class="fleur-community__bg-right">
            {% if section.settings.image != blank %}
              {{
                section.settings.image
                | image_url: width: 2800
                | image_tag:
                  loading: 'lazy',
                  class: 'fleur-community__bg-image',
                  alt: section.settings.image_alt | escape
              }}
            {% endif %}
          </div>
        </div>

        <!-- FOREGROUND CONTENT (container-aligned) -->
        <div class="container">
          <div class="fleur-community__grid">

            <!-- LEFT CONTENT -->
            <div class="fleur-community__content fleur-community__content--left">
              <div class="fleur-community__inner">

                {% if section.settings.micro_text != blank %}
                  <div class="fleur-community__micro">
                    <span class="fleur-community__dot" aria-hidden="true"></span>
                    <span>{{ section.settings.micro_text }}</span>
                  </div>
                {% endif %}

                {% if section.settings.headline != blank %}
                  <h2 class="fleur-community__headline">
                    {{ section.settings.headline | newline_to_br }}
                  </h2>
                {% endif %}

                {% if section.settings.paragraph != blank %}
                  <div class="fleur-community__paragraph rte">
                    {{ section.settings.paragraph }}
                  </div>
                {% endif %}

                {% if section.settings.cta_label != blank and section.settings.cta_link != blank %}
                  <a class="fleur-community__cta" href="{{ section.settings.cta_link }}">
                    {{ section.settings.cta_label }}
                  </a>
                {% endif %}

              </div>
            </div>

            <!-- RIGHT SPACER -->
            <div class="fleur-community__content fleur-community__content--right" aria-hidden="true"></div>

          </div>
        </div>

      </div>
    </div>

    <!-- =========================
         MOBILE LAYOUT
    ========================== -->
    <div class="fleur-community__mobile">

      <!-- LEFT PANEL: FULL BLEED BG, TEXT INSIDE CONTAINER -->
      <div class="fleur-community__mobile-left">
        <div class="container">
          <div class="fleur-community__mobile-inner">

            {% if section.settings.micro_text != blank %}
              <div class="fleur-community__micro">
                <span class="fleur-community__dot" aria-hidden="true"></span>
                <span>{{ section.settings.micro_text }}</span>
              </div>
            {% endif %}

            {% if section.settings.headline != blank %}
              <h2 class="fleur-community__headline">
                {{ section.settings.headline | newline_to_br }}
              </h2>
            {% endif %}

            {% if section.settings.paragraph != blank %}
              <div class="fleur-community__paragraph rte">
                {{ section.settings.paragraph }}
              </div>
            {% endif %}

            {% if section.settings.cta_label != blank and section.settings.cta_link != blank %}
              <a class="fleur-community__cta" href="{{ section.settings.cta_link }}">
                {{ section.settings.cta_label }}
              </a>
            {% endif %}

          </div>
        </div>
      </div>

      <!-- IMAGE PANEL: FULL BLEED -->
      <div class="fleur-community__mobile-right">
        {% if section.settings.image != blank %}
          {{
            section.settings.image
            | image_url: width: 2000
            | image_tag:
              loading: 'lazy',
              class: 'fleur-community__mobile-image',
              alt: section.settings.image_alt | escape
          }}
        {% endif %}
      </div>

    </div>

  </div>
</section>

{% style %}
.fleur-community--{{ section.id }}{
  --left-bg: {{ section.settings.left_bg }};
  --text-color: {{ section.settings.text_color }};
  --dot-color: {{ section.settings.dot_color }};
  --min-h: {{ section.settings.min_height }}px;

  --pad-y: {{ section.settings.pad_y }}px;
  --pad-x: {{ section.settings.pad_x }}px;

  --headline-size: {{ section.settings.headline_size_desktop }}px;
  --headline-size-mobile: {{ section.settings.headline_size_mobile }}px;
  --headline-weight: {{ section.settings.headline_weight }};

  --body-size: {{ section.settings.body_size }}px;
  --paragraph-max: {{ section.settings.paragraph_max_width }}px;

  --image-pos: {{ section.settings.image_position }};
}

/* ✅ THE IMPORTANT PART:
   Break out of any parent container/padding and go full-bleed */
.fleur-community--{{ section.id }} .fleur-community__bleed{
  width: 100vw;
  margin-left: calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
}

/* shared typography */
.fleur-community--{{ section.id }} .fleur-community__micro{
  display: inline-flex;
  align-items: center;
  gap: 10px;
  font-size: 14px;
  opacity: 0.95;
  color: var(--text-color);
}

.fleur-community--{{ section.id }} .fleur-community__dot{
  width: 8px;
  height: 8px;
  border-radius: 999px;
  background: var(--dot-color);
  flex: 0 0 auto;
}

.fleur-community--{{ section.id }} .fleur-community__headline{
  margin: 0;
  font-size: var(--headline-size);
  font-weight: var(--headline-weight);
  line-height: 1.02;
  text-transform: lowercase;
  color: var(--text-color);
}

.fleur-community--{{ section.id }} .fleur-community__paragraph{
  max-width: var(--paragraph-max);
  font-size: var(--body-size);
  line-height: 1.5;
  opacity: 0.92;
  color: var(--text-color);
}

.fleur-community--{{ section.id }} .fleur-community__paragraph p:last-child{ margin-bottom: 0; }

.fleur-community--{{ section.id }} .fleur-community__cta{
  margin-top: auto;
  display: inline-block;
  padding: 12px 20px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.25);
  color: var(--text-color);
  text-decoration: none;
  font-size: 14px;
}

/* =========================
   DESKTOP
========================= */
.fleur-community--{{ section.id }} .fleur-community__desktop{ display: block; }
.fleur-community--{{ section.id }} .fleur-community__mobile{ display: none; }

.fleur-community--{{ section.id }} .fleur-community__bleed {
  padding: 60px 0 !important;
}


.fleur-community--{{ section.id }} .fleur-community__stage{
  position: relative;
  min-height: var(--min-h);
  overflow: hidden;
  padding: 60px 0;
}

.fleur-community--{{ section.id }} .fleur-community__bg{
  position: absolute;
  inset: 0;
  display: flex;
  z-index: 0;
}

.fleur-community--{{ section.id }} .fleur-community__bg-left,
.fleur-community--{{ section.id }} .fleur-community__bg-right{
  width: 50%;
}

.fleur-community--{{ section.id }} .fleur-community__bg-left{
  background: var(--left-bg);
}

.fleur-community--{{ section.id }} .fleur-community__bg-right{
  overflow: hidden;
}

.fleur-community--{{ section.id }} .fleur-community__bg-image{
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: var(--image-pos);
  display: block;
}

.fleur-community--{{ section.id }} .container{
  position: relative;
  z-index: 1;
}

.fleur-community--{{ section.id }} .fleur-community__grid{
  display: grid;
  grid-template-columns: 1fr 1fr;
  min-height: var(--min-h);
}

.fleur-community--{{ section.id }} .fleur-community__inner{
  height: 100%;
  padding: var(--pad-y) var(--pad-x);
  display: flex;
  flex-direction: column;
  gap: 100px;
  padding-bottom: 0;
}

/* =========================
   MOBILE
========================= */
@media (max-width: 989px){
  .fleur-community--{{ section.id }} .fleur-community__desktop{ display: none; }
  .fleur-community--{{ section.id }} .fleur-community__mobile{ display: block; }

  .fleur-community--{{ section.id }} .fleur-community__headline{
    font-size: var(--headline-size-mobile);
    line-height: 1.06;
  }

  /* Full-bleed left background */
  .fleur-community--{{ section.id }} .fleur-community__mobile-left{
    background: var(--left-bg);
    padding: 60px 0; /* matches desktop vertical rhythm; adjust if you want */
  }

  /* Container handles left/right padding for text */
  .fleur-community--{{ section.id }} .fleur-community__mobile-inner{
    padding: {{ section.settings.pad_y_mobile }}px 0;
    display: flex;
    flex-direction: column;
    gap: 40px;
  }

  @media (max-width: 989px) {
  .fleur-community--{{ section.id }} .fleur-community__bleed {
    padding: 30px 0 !important;
  }

  .fleur-community__paragraph.rte {
    padding-bottom: 0px !important;
    margin: 0px !important;
  }
}


  /* Full-bleed image below */
  .fleur-community--{{ section.id }} .fleur-community__mobile-right{
    width: 100%;
    height: {{ section.settings.mobile_image_height }}px;
    overflow: hidden;
    background: #eee;
  }

  .fleur-community--{{ section.id }} .fleur-community__mobile-image{
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: var(--image-pos);
    display: block;
  }
}
{% endstyle %}

{% schema %}
{
  "name": "Fleur Community",
  "settings": [
    { "type": "text", "id": "micro_text", "label": "Micro text", "default": "a collective rooted in confidence" },
    { "type": "textarea", "id": "headline", "label": "Headline", "default": "the\nfleur\ncommunity:\nwomen,\nrising" },
    { "type": "range", "id": "headline_weight", "label": "Headline font weight", "min": 300, "max": 900, "step": 100, "default": 700 },
    { "type": "richtext", "id": "paragraph", "label": "Paragraph", "default": "<p>This is for the women who show up—for themselves and for each other.</p>" },

    { "type": "header", "content": "Right image" },
    { "type": "image_picker", "id": "image", "label": "Right image" },
    { "type": "text", "id": "image_alt", "label": "Image alt", "default": "Fleur community" },
    {
      "type": "select",
      "id": "image_position",
      "label": "Image focal point",
      "default": "center",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" },
        { "value": "top", "label": "Top" },
        { "value": "bottom", "label": "Bottom" }
      ]
    },

    { "type": "header", "content": "Colors" },
    { "type": "color", "id": "left_bg", "label": "Left background", "default": "#3A120C" },
    { "type": "color", "id": "text_color", "label": "Text color", "default": "#FFFFFF" },
    { "type": "color", "id": "dot_color", "label": "Dot color", "default": "#FFFFFF" },

    { "type": "header", "content": "Sizing & spacing" },
    { "type": "range", "id": "headline_size_desktop", "label": "Headline size (desktop)", "min": 32, "max": 110, "step": 1, "default": 72 },
    { "type": "range", "id": "headline_size_mobile", "label": "Headline size (mobile)", "min": 26, "max": 72, "step": 1, "default": 44 },
    { "type": "range", "id": "body_size", "label": "Body size", "min": 12, "max": 22, "step": 1, "default": 16 },
    { "type": "range", "id": "paragraph_max_width", "label": "Paragraph max width", "min": 300, "max": 900, "step": 10, "default": 560 },

    { "type": "range", "id": "min_height", "label": "Section min height (desktop)", "min": 420, "max": 900, "step": 10, "default": 620 },
    { "type": "range", "id": "mobile_image_height", "label": "Mobile image height", "min": 220, "max": 720, "step": 10, "default": 360 },

    { "type": "range", "id": "pad_y", "label": "Padding Y (desktop)", "min": 20, "max": 140, "step": 2, "default": 64 },
    { "type": "range", "id": "pad_x", "label": "Padding X (desktop)", "min": 0, "max": 160, "step": 2, "default": 0 },
    { "type": "range", "id": "pad_y_mobile", "label": "Padding Y (mobile)", "min": 0, "max": 80, "step": 2, "default": 28 },

    { "type": "header", "content": "Optional CTA" },
    { "type": "text", "id": "cta_label", "label": "Button label", "default": "join" },
    { "type": "url", "id": "cta_link", "label": "Button link" }
  ],
  "presets": [
    { "name": "Fleur Community" }
  ]
}
{% endschema %}
