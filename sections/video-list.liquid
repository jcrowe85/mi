{{ 'video-list.css' | asset_url | stylesheet_tag }}
{% style %}
	.section-{{ section.id }}-padding {
	{% if section.settings.padding_top == 'no-indent' %}
		padding-top: 0;
	{% else %}
		padding-top: 3.2rem;
	{% endif %} 

	{% if section.settings.padding_bottom == 'no-indent' %}
		padding-bottom: 0;
	{% else %}
		padding-bottom: 3.2rem;
	{% endif %}
}
 
@media screen and (min-width: 990px) { 
	.section-{{ section.id }}-padding {
		{% if section.settings.padding_top == 'no-indent' %}
			padding-top: 0;
		{% elsif section.settings.padding_top == 'l' %}
			padding-top: 4rem;
		{% else %}
			padding-top: 3.2rem;
		{% endif %}

		{% if section.settings.padding_bottom == 'no-indent' %}
			padding-bottom: 0;
		{% elsif section.settings.padding_bottom == 'l' %}
			padding-bottom: 4rem;
		{% else %}
			padding-bottom: 3.2rem;
		{% endif %}
	}
}

@media screen and (min-width: 1200px) { 
	.section-{{ section.id }}-padding {
		{% if section.settings.padding_top == 'no-indent' %}
			padding-top: 0;
		{% elsif section.settings.padding_top == 'l' %}
			padding-top: 8rem;
		{% elsif section.settings.padding_top == 'm' %}
			padding-top: 4rem;
		{% else %}
			padding-top: 3.2rem;
		{% endif %}

		{% if section.settings.padding_bottom == 'no-indent' %}
			padding-bottom: 0;
		{% elsif section.settings.padding_bottom == 'l' %}
			padding-bottom: 8rem;
		{% elsif section.settings.padding_bottom == 'm' %}
			padding-bottom: 4rem;
		{% else %}
			padding-bottom: 3.2rem;
		{% endif %}
	}
}

@media screen and (min-width: 1560px) { 
	.section-{{ section.id }}-padding {
		{% if section.settings.padding_top == 'no-indent' %}
			padding-top: 0;
		{% elsif section.settings.padding_top == 'l' %}
			padding-top: 16rem;
		{% elsif section.settings.padding_top == 'm' %}
			padding-top: 8rem;
		{% elsif section.settings.padding_top == 's' %}
			padding-top: 4rem;
		{% else %}
			padding-top: 3.2rem;
		{% endif %}

		{% if section.settings.padding_bottom == 'no-indent' %}
			padding-bottom: 0;
		{% elsif section.settings.padding_bottom == 'l' %}
			padding-bottom: 16rem;
		{% elsif section.settings.padding_bottom == 'm' %}
			padding-bottom: 8rem;
		{% elsif section.settings.padding_bottom == 's' %}
			padding-bottom: 4rem;
		{% else %}
			padding-bottom: 3.2rem;
		{% endif %}
	}
}
{% endstyle %}

<div class="video-lsit-section {{ section.id }} color-{{ section.settings.color_scheme }} background section-{{ section.id }}-padding">
  <div class="container">
	{% if section.settings.heading != blank or section.settings.subheading != blank %}
		<div class="heading-sections-wrapper section-header__line">
		{% if section.settings.heading != blank %}
			<h2 class="h1 heading-sections">
			{{ section.settings.heading | newline_to_br }}
			</h2>
	    {% endif %} 
		{% if section.settings.subheading != blank %}
			<p class="">
				{{ section.settings.subheading }}
			</p>
		{% endif %}
		</div>
    {% endif %}
  </div>

	<div class="swiper video-list-container">
		<div class="swiper-wrapper">
			{% for block in section.blocks %}
				<div class="swiper-slide">
					<div class="swiper-slide-video-wrap">
          <div class="video-container-wrapper">
            {% assign poster_image = block.settings.video_url.preview_image %}
            
            <video
              playsinline
              preload="metadata"
              poster="{{ poster_image | image_url: width: 800 }}"
              class="custom-video-player"
			  muted
            >
              {% for source in block.settings.video_url.sources %}
                <source src="{{ source.url }}" type="{{ source.format | prepend: 'video/' }}">
              {% endfor %}
            </video>
            
            <div class="video-poster-overlay">
              <button class="play-button" aria-label="Play video">
				<svg class="play-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><title id="play-icon">Play icon</title><path d="M12.4231 8L5.5 12.5L5.5 3.5L12.4231 8Z" fill="currentColor"></path></svg>
                
                 </button>
            </div>
          </div>
        </div>
				</div>
			{% endfor %}
		</div>
	</div>
</div> 

<script>
	document.addEventListener('DOMContentLoaded', function(){
		new Swiper('.video-list-container', {
			loop: true,
			nextButton: '.swiper-button-next',
			prevButton: '.swiper-button-prev',
			slidesPerView:1.4,
			paginationClickable: true,
			centeredSlides: true,
			spaceBetween: 20
		});
	});


       const videoWraps = document.querySelectorAll('.video-lsit-section.{{ section.id }} .video-container-wrapper');
        
        videoWraps.forEach(wrap => {
            const video = wrap.querySelector('video');
            const posterOverlay = wrap.querySelector('.video-poster-overlay');

            if (video && posterOverlay) {
                // Add click listener to the entire wrapper
                wrap.addEventListener('click', function() {
                    // Check if the video is paused (i.e., displaying the poster)
                    if (video.paused) {
                        // When playing, add the class to hide the overlay
                        wrap.classList.add('video-playing');
                        // Crucially, call load() first to ensure Safari loads the source
                        video.load(); 
                        video.play();
                    } else {
                        // When pausing, remove the class to show the poster
                        wrap.classList.remove('video-playing');
                        video.pause();
                    }
                });

                // Event listener to reset to poster when video ends
                video.addEventListener('ended', function() {
                    wrap.classList.remove('video-playing');
                });
            }
     
        });

</script>


{% schema %}
{
  "name": "Video List",
  "tag": "section",
  "class": "video-list-section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Stories from scientists, innovators, and members like you."
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Text"
    },
    {
        "type": "color_scheme",
        "id": "color_scheme",
        "default": "background-2",
        "label": "t:sections.all.color_scheme.label"
	},
    {
			"type": "header",
			"content": "t:sections.all.section-padding.header.content"
		},
		{
			"type": "select",
			"id": "padding_top",
			"options": [
				{
					"value": "no-indent",
					"label": "t:sections.all.section-padding.options__1.label"
				},
				{
					"value": "xs",
					"label": "t:sections.all.section-padding.options__2.label"
				},
				{
					"value": "s",
					"label": "t:sections.all.section-padding.options__3.label"
				},
				{
					"value": "m",
					"label": "t:sections.all.section-padding.options__4.label"
				},
				{
					"value": "l",
					"label": "t:sections.all.section-padding.options__5.label"
				}
			],
			"default": "s",
			"label": "t:sections.all.section-padding.padding_top.label"
		},
		{
			"type": "select",
			"id": "padding_bottom",
			"options": [
				{
					"value": "no-indent",
					"label": "t:sections.all.section-padding.options__1.label"
				},
				{
					"value": "xs",
					"label": "t:sections.all.section-padding.options__2.label"
				},
				{
					"value": "s",
					"label": "t:sections.all.section-padding.options__3.label"
				},
				{
					"value": "m",
					"label": "t:sections.all.section-padding.options__4.label"
				},
				{
					"value": "l",
					"label": "t:sections.all.section-padding.options__5.label"
				}
			],
			"default": "s",
			"label": "t:sections.all.section-padding.padding_bottom.label"
		}
  ],
  "blocks": [
    {
      "type": "video",
      "name": "Video",
      "settings": [
        {
          "type": "video",
          "id": "video_url",
          "label": "Video Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Video List"
    }
  ]
}
{% endschema %}